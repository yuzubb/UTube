{% extends "base.html" %}

{% block content %}
<div class="watch-page-container">
    <div class="main-video-area">
        
        <div class="video-player-container">
            {% if video_stream_url %}
            <video controls class="html5-video-player" poster="{{ video.videoThumbnails[0].url }}">
                <source src="{{ video_stream_url }}" type="video/mp4">
                ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å‹•ç”»ã®å†ç”Ÿã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚
            </video>
            {% else %}
            <div class="video-error-message">
                ãˆã‚‰ãƒ¼
            </div>
            {% endif %}
        </div>

        <div class="video-details-section">
            <h1 class="video-title-watch">{{ video.title }}</h1>
            
            <div class="stats-bar">
                <span class="view-count">{{ video.viewCount | format_views }}</span>
                <span class="published-date">ãƒ»{{ video.publishedText }}</span>
            </div>
            
            <hr class="separator">
            
            <div class="channel-and-description">
                <div class="channel-info">
                    <a href="/channel/{{ video.authorId }}">
                        <img src="{{ video.authorThumbnails[0].url }}" alt="Channel Icon" class="channel-icon-watch">
                    </a>
                    <div class="author-details">
                        <p class="author-name">{{ video.author }}</p>
                        {% if video.subCount %}
                        <p class="subscriber-count">{{ video.subCount | format_views }}äºº</p>
                        {% endif %}
                    </div>
                </div>
                <pre class="video-description">{{ video.description }}</pre>
            </div>

            <div class="comments-section">
                <h2 class="comment-count-header">{{ video.commentCount | format_views }} ä»¶ã®ã‚³ãƒ¡ãƒ³ãƒˆ</h2>
                
                {% for comment in video.comments %}
                <div class="comment-card">
                    <img src="{{ comment.authorThumbnails[0].url }}" alt="Commenter Icon" class="comment-author-icon">
                    <div class="comment-content">
                        <div class="comment-header">
                            <span class="comment-author">{{ comment.author }}</span>
                            <span class="comment-time">{{ comment.publishedText }}</span>
                        </div>
                        <p class="comment-body">{{ comment.content }}</p>
                        <div class="comment-actions">
                            <span class="comment-likes">ğŸ‘ {{ comment.likeCount }}</span>
                            <span class="comment-reply">è¿”ä¿¡</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

    </div>

    <div class="related-videos-sidebar">
        <h3 class="related-videos-title">é–¢é€£å‹•ç”»</h3>
        {% for related in related_videos %}
        <a href="/watch/{{ related.videoId }}" class="related-video-card">
            <div class="related-thumbnail-container">
                <img src="{{ related.videoThumbnails[0].url }}" alt="{{ related.title }}" class="related-thumbnail">
                <span class="related-video-duration">{{ related.lengthSeconds | format_duration }}</span>
            </div>
            <div class="related-video-info">
                <h3 class="related-video-title">{{ related.title }}</h3>
                <p class="related-channel-name">{{ related.author }}</p>
                <p class="related-metadata">{{ related.viewCount | format_views }} â€¢ {{ related.publishedText }}</p>
            </div>
        </a>
        {% endfor %}
    </div>
</div>
{% endblock %}
